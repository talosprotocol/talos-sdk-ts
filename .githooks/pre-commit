#!/usr/bin/env bash
set -euo pipefail

node scripts/version-sync.mjs
git add package.json

if [ -f package-lock.json ]; then
  git add package-lock.json
fi

npx lint-staged
npm run typecheck
npm run test

if [ -f scripts/gates-contracts.sh ]; then
  bash scripts/gates-contracts.sh
fi
